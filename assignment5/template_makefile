# To be configured by configure.sh:
# 	black_fitch_path=/path/to/black-fitch/prac5

# TODO: More elegant solution than these duplicate values

javaFitchPath=$(black_fitch_path)/../java-fitch
javaFitchFiles=$(javaFitchPath)/JavaFitch.java $(black_fitch_path)/JavaFitchRunner.java $(javaFitchPath)/JavaFitchUnitTest.java \
$(javaFitchPath)/JLogger.java $(black_fitch_path)/JavaFitchRunner_white.java $(black_fitch_path)/GraphUtils.java

javaFitchFilesLocal=JavaFitchRunner.java JavaFitchUnitTest.java JLogger.java JavaFitch.java GraphUtils.java

javaFitchFilesLocal_white=JavaFitchUnitTest.java JLogger.java JavaFitch.java JavaFitchRunner_white.java GraphUtils.java

task1_TestFiles=$(black_fitch_path)/tests_Task1.java
task1_TestFilesLocal=tests_Task1.java

task1_white_TestFiles=$(black_fitch_path)/tests_white_Task1.java
task1_white_TestFilesLocal=tests_white_Task1.java
javaFitchRunnerName_white=JavaFitchRunner_white

task1_UserSources=Graph.java

javaFitchRunnerName=JavaFitchRunner

DummyLogFile=$(javaFitchPath)/JLogger_Stub.java

graphsDir=$(black_fitch_path)/graphs
graphs=$(graphsDir)/g1.txt $(graphsDir)/duplicates.txt
graphsLocal=g1.txt duplicates.txt

task1:
	@echo "\nCopying Java Fitch..."
	cp -f $(javaFitchFiles) .
	cp -f $(graphs) .
	cp -f $(task1_TestFiles) .
	@echo ""

	javac $(javaFitchFilesLocal) $(task1_TestFilesLocal) $(task1_UserSources)
	java $(javaFitchRunnerName)

	@echo "\nCleaning up..."
	rm -f $(task1_TestFilesLocal)
	rm -f $(javaFitchFilesLocal)
	rm -f $(javaFitchFilesLocal_white)
	rm -f $(graphsLocal)
	cp -f $(DummyLogFile) JLogger.java

task1_white:
	@echo "\nCopying Java Fitch..."
	cp -f $(javaFitchFiles) .
	cp -f $(graphs) .
	cp -f $(task1_white_TestFiles) .
	@echo ""

	javac $(javaFitchFilesLocal_white) $(task1_white_TestFilesLocal) $(task1_UserSources)
	java $(javaFitchRunnerName_white)

	@echo "\nCleaning up..."
	rm -f $(task1_white_TestFilesLocal)
	rm -f $(javaFitchFilesLocal_white)
	rm -f $(graphsLocal)
	rm -f $(javaFitchFilesLocal)
	cp -f $(DummyLogFile) JLogger.java

clean:
	rm -f $(task1_test_files_local)
	rm -f *.class
	rm -fr black-fitch_graphs

# Configure and copy the latest makefile
update:
	@cd "$(black_fitch_path)" && ./configure.sh -q
	@mv "$(black_fitch_path)/black-fitch-makefile" .
	@echo "black-fitch-makefile has been updated to the latest version!"

# Pull black-fitch, configure and copy the latest makefile
pull:
	@echo "Pull black-fitch from  GitHub..."
	cd "$(black_fitch_path)" && git pull origin assignment2

	@cd "$(black_fitch_path)" && ./configure.sh -q
	@mv "$(black_fitch_path)/black-fitch-makefile" .
	@echo "black-fitch-makefile has been updated to the latest version!"
